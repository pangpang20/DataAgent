<div align="center">
  <h1>Audaque DataAgent</h1>
  <p>
    <strong>åŸºäº Spring AI çš„ä¼ä¸šçº§æ™ºèƒ½æ•°æ®åˆ†æå¸ˆ</strong>
  </p>
  <p>
     Text-to-SQL | Python æ·±åº¦åˆ†æ | æ™ºèƒ½æŠ¥å‘Š | MCP æœåŠ¡å™¨ | RAG å¢å¼º
  </p>

  <p>
    <img src="https://img.shields.io/badge/Spring%20Boot-3.4.8+-green" alt="Spring Boot">
    <img src="https://img.shields.io/badge/Java-17+-orange" alt="Java">
    <img src="https://img.shields.io/badge/License-Apache%202.0-red" alt="License">
  </p>

   <p>
    <a href="#-é¡¹ç›®ç®€ä»‹">é¡¹ç›®ç®€ä»‹</a> â€¢ 
    <a href="#-æ ¸å¿ƒç‰¹æ€§">æ ¸å¿ƒç‰¹æ€§</a> â€¢ 
    <a href="#-å¿«é€Ÿå¼€å§‹">å¿«é€Ÿå¼€å§‹</a> â€¢ 
    <a href="#-æ–‡æ¡£å¯¼èˆª">æ–‡æ¡£å¯¼èˆª</a> â€¢ 
  </p>
</div>

<br/>

<div align="center">
    <img src="img/LOGO.png" alt="DataAgent" width="200" style="border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
</div>

<br/>

## ğŸ“– é¡¹ç›®ç®€ä»‹

**DataAgent** æ˜¯ä¸€ä¸ªåŸºäº **Spring AI Audaque Graph** æ‰“é€ çš„ä¼ä¸šçº§æ™ºèƒ½æ•°æ®åˆ†æ Agentã€‚å®ƒè¶…è¶Šäº†ä¼ ç»Ÿçš„ Text-to-SQL å·¥å…·ï¼Œè¿›åŒ–ä¸ºä¸€ä¸ªèƒ½å¤Ÿæ‰§è¡Œ **Python æ·±åº¦åˆ†æ**ã€ç”Ÿæˆ **å¤šç»´åº¦å›¾è¡¨æŠ¥å‘Š** çš„ AI æ™ºèƒ½æ•°æ®åˆ†æå¸ˆã€‚

ç³»ç»Ÿé‡‡ç”¨é«˜åº¦å¯æ‰©å±•çš„æ¶æ„è®¾è®¡ï¼Œ**å…¨é¢å…¼å®¹ OpenAI æ¥å£è§„èŒƒ**çš„å¯¹è¯æ¨¡å‹ä¸ Embedding æ¨¡å‹ï¼Œå¹¶æ”¯æŒ**çµæ´»æŒ‚è½½ä»»æ„å‘é‡æ•°æ®åº“**ã€‚æ— è®ºæ˜¯ç§æœ‰åŒ–éƒ¨ç½²è¿˜æ˜¯æ¥å…¥ä¸»æµå¤§æ¨¡å‹æœåŠ¡ï¼ˆå¦‚ Qwen, Deepseekï¼‰ï¼Œéƒ½èƒ½è½»æ¾é€‚é…ï¼Œä¸ºä¼ä¸šæä¾›çµæ´»ã€å¯æ§çš„æ•°æ®æ´å¯ŸæœåŠ¡ã€‚

åŒæ—¶ï¼Œæœ¬é¡¹ç›®åŸç”Ÿæ”¯æŒ **MCP (Model Context Protocol)**ï¼Œå¯ä½œä¸º MCP æœåŠ¡å™¨æ— ç¼é›†æˆåˆ° Claude Desktop ç­‰æ”¯æŒ MCP çš„ç”Ÿæ€å·¥å…·ä¸­ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

| ç‰¹æ€§                | è¯´æ˜                                                                                    |
| :------------------ | :-------------------------------------------------------------------------------------- |
| **æ™ºèƒ½æ•°æ®åˆ†æ**    | åŸºäº StateGraph çš„ Text-to-SQL è½¬æ¢ï¼Œæ”¯æŒå¤æ‚çš„å¤šè¡¨æŸ¥è¯¢å’Œå¤šè½®å¯¹è¯æ„å›¾ç†è§£ã€‚             |
| **Python æ·±åº¦åˆ†æ** | å†…ç½® Docker/Local Python æ‰§è¡Œå™¨ï¼Œè‡ªåŠ¨ç”Ÿæˆå¹¶æ‰§è¡Œ Python ä»£ç è¿›è¡Œç»Ÿè®¡åˆ†æä¸æœºå™¨å­¦ä¹ é¢„æµ‹ã€‚ |
| **æ™ºèƒ½æŠ¥å‘Šç”Ÿæˆ**    | åˆ†æç»“æœè‡ªåŠ¨æ±‡æ€»ä¸ºåŒ…å« ECharts å›¾è¡¨çš„ HTML/Markdown æŠ¥å‘Šï¼Œæ‰€è§å³æ‰€å¾—ã€‚                  |
| **äººå·¥åé¦ˆæœºåˆ¶**    | ç‹¬åˆ›çš„ Human-in-the-loop æœºåˆ¶ï¼Œæ”¯æŒç”¨æˆ·åœ¨è®¡åˆ’ç”Ÿæˆé˜¶æ®µè¿›è¡Œå¹²é¢„å’Œè°ƒæ•´ã€‚                   |
| **RAG æ£€ç´¢å¢å¼º**    | é›†æˆå‘é‡æ•°æ®åº“ï¼Œæ”¯æŒå¯¹ä¸šåŠ¡å…ƒæ•°æ®ã€æœ¯è¯­åº“çš„è¯­ä¹‰æ£€ç´¢ï¼Œæå‡ SQLç”Ÿæˆå‡†ç¡®ç‡ã€‚                |
| **å¤šæ¨¡å‹è°ƒåº¦**      | å†…ç½®æ¨¡å‹æ³¨å†Œè¡¨ï¼Œæ”¯æŒè¿è¡Œæ—¶åŠ¨æ€åˆ‡æ¢ä¸åŒçš„ LLM å’Œ Embedding æ¨¡å‹ã€‚                        |
| **MCP æœåŠ¡å™¨**      | éµå¾ª MCP åè®®ï¼Œæ”¯æŒä½œä¸º Tool Server å¯¹å¤–æä¾› NL2SQL å’Œ æ™ºèƒ½ä½“ç®¡ç†èƒ½åŠ›ã€‚                 |
| **API Key ç®¡ç†**    | å®Œå–„çš„ API Key ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œæ”¯æŒç»†ç²’åº¦çš„æƒé™æ§åˆ¶ã€‚                                     |

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

![dataagent-structure](img/dataagent-structure.png)

## ğŸš€ å¿«é€Ÿå¼€å§‹

> è¯¦ç»†çš„å®‰è£…å’Œé…ç½®æŒ‡å—è¯·å‚è€ƒ [ğŸ“‘ å¿«é€Ÿå¼€å§‹æ–‡æ¡£](docs/QUICK_START.md)ã€‚

### 1. å‡†å¤‡ç¯å¢ƒ

- JDK 17+
- Maven 3.6.3+ (æ¨è 3.9.9ï¼Œé¡¹ç›®è‡ªå¸¦ Maven Wrapper)
- MySQL 5.7+
- Node.js 16+
- npm 9.x æˆ– 10.x (æ¨è 10.xï¼Œnpm 11.6 å­˜åœ¨å…¼å®¹æ€§é—®é¢˜)

### 2. ç¼–è¯‘æ„å»º

#### åç«¯ç¼–è¯‘

```bash
# Windows ç³»ç»Ÿ
.\mvnw.cmd -B clean compile -DskipTests=true

# Linux/Mac ç³»ç»Ÿ
./mvnw -B clean compile -DskipTests=true

# æˆ–ä½¿ç”¨ Mavenï¼ˆå¦‚æœå·²å®‰è£…ï¼‰
mvn -B clean compile -DskipTests=true
```

#### å‰ç«¯ç¼–è¯‘

```bash
# å®‰è£… yarnï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
npm install -g yarn

# è¿›å…¥å‰ç«¯ç›®å½•
cd data-agent-frontend

# ä½¿ç”¨ yarn å®‰è£…ä¾èµ–
yarn install

# ç¼–è¯‘æ„å»º
yarn build
```

### 3. å¯åŠ¨æœåŠ¡

```bash
# 1. å¯¼å…¥æ•°æ®åº“
mysql -u root -p < data-agent-management/src/main/resources/sql/schema.sql

# 2. å¯åŠ¨åç«¯
cd data-agent-management
# Windows ç³»ç»Ÿ
.\mvnw.cmd spring-boot:run
# Linux/Mac ç³»ç»Ÿ
./mvnw spring-boot:run

# 3. å¯åŠ¨å‰ç«¯ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
cd data-agent-frontend
yarn install && yarn dev
```

### 4. ç”Ÿäº§æ‰“åŒ…

#### åç«¯æ‰“åŒ…

```bash
# Windows ç³»ç»Ÿ
.\mvnw.cmd -B clean package -DskipTests=true

# Linux/Mac ç³»ç»Ÿ
./mvnw -B clean package -DskipTests=true

# æ‰“åŒ…æ–‡ä»¶ä½ç½®ï¼šdata-agent-management/target/*.jar
```

#### å‰ç«¯æ‰“åŒ…

```bash
cd data-agent-frontend

# ç”Ÿäº§ç¯å¢ƒæ„å»º
yarn build

# æ„å»ºäº§ç‰©ä½ç½®ï¼šdata-agent-frontend/dist/
```

### 5. ç”Ÿäº§éƒ¨ç½²ï¼ˆä½¿ç”¨ JAR åŒ…ï¼‰

#### 5.1 å‡†å¤‡é…ç½®æ–‡ä»¶

```bash
# 1. åˆ›å»ºéƒ¨ç½²ç›®å½•
mkdir -p /opt/dataagent
cd /opt/dataagent

# 2. å¤åˆ¶é…ç½®æ–‡ä»¶æ¨¡æ¿
cp /path/to/DataAgent/application.yml.sample ./application.yml

# 3. ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹æ•°æ®åº“è¿æ¥ç­‰ä¿¡æ¯
vi application.yml
```

**é‡è¦é…ç½®é¡¹è¯´æ˜**ï¼š

| é…ç½®é¡¹                       | è¯´æ˜           | å¿…é¡»ä¿®æ”¹   |
| ---------------------------- | -------------- | ---------- |
| `spring.datasource.url`      | æ•°æ®åº“è¿æ¥åœ°å€ | âœ… æ˜¯       |
| `spring.datasource.username` | æ•°æ®åº“ç”¨æˆ·å   | âœ… æ˜¯       |
| `spring.datasource.password` | æ•°æ®åº“å¯†ç      | âœ… æ˜¯       |
| `server.port`                | åç«¯æœåŠ¡ç«¯å£   | âŒ å¯é€‰     |
| `logging.file.name`          | æ—¥å¿—æ–‡ä»¶è·¯å¾„   | âŒ å»ºè®®é…ç½® |

> å®Œæ•´é…ç½®è¯´æ˜è¯·å‚è€ƒ [`application.yml.sample`](application.yml.sample) æ–‡ä»¶ä¸­çš„æ³¨é‡Š

#### 5.2 å¤åˆ¶ JAR åŒ…

```bash
# å¤åˆ¶åç«¯ JAR åŒ…åˆ°éƒ¨ç½²ç›®å½•
cp data-agent-management/target/spring-ai-audaque-data-agent-management-*.jar /opt/dataagent/dataagent-backend.jar
```

#### 5.3 å¯åŠ¨åç«¯æœåŠ¡

**æ–¹å¼1ï¼šä½¿ç”¨å¤–éƒ¨é…ç½®æ–‡ä»¶å¯åŠ¨ï¼ˆæ¨èï¼‰**

```bash
cd /opt/dataagent

# Spring Boot ä¼šè‡ªåŠ¨åŠ è½½åŒçº§ç›®å½•æˆ– config/ å­ç›®å½•çš„ application.yml
java -jar dataagent-backend.jar

# æˆ–æŒ‡å®šé…ç½®æ–‡ä»¶è·¯å¾„
java -jar dataagent-backend.jar --spring.config.location=./application.yml
```

**æ–¹å¼2ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡ï¼ˆæ•æ„Ÿä¿¡æ¯æ¨èï¼‰**

```bash
# è®¾ç½®ç¯å¢ƒå˜é‡
export DATA_AGENT_DATASOURCE_URL="jdbc:mysql://192.168.1.100:3306/data_agent"
export DATA_AGENT_DATASOURCE_USERNAME="prod_user"
export DATA_AGENT_DATASOURCE_PASSWORD="your_password"

# å¯åŠ¨æœåŠ¡
java -jar dataagent-backend.jar
```

**æ–¹å¼3ï¼šå‘½ä»¤è¡Œå‚æ•°è¦†ç›–**

```bash
java -jar dataagent-backend.jar \
  --spring.datasource.url="jdbc:mysql://192.168.1.100:3306/data_agent" \
  --spring.datasource.username="prod_user" \
  --spring.datasource.password="your_password"
```

#### 5.4 ç”Ÿäº§ç¯å¢ƒå¯åŠ¨å»ºè®®

**ä½¿ç”¨ JVM å‚æ•°ä¼˜åŒ–**ï¼š

```bash
java -Xmx2g -Xms2g \
  -XX:+UseG1GC \
  -XX:+HeapDumpOnOutOfMemoryError \
  -XX:HeapDumpPath=/var/log/dataagent/heapdump.hprof \
  -Dfile.encoding=UTF-8 \
  -jar dataagent-backend.jar
```

**åå°è¿è¡Œå¹¶è®°å½•æ—¥å¿—**ï¼š

```bash
# ä½¿ç”¨ nohup åå°è¿è¡Œï¼ˆæ”¯æŒ IPv4 å’Œ IPv6 åŒæ ˆï¼‰
nohup java -Xmx2g -Xms2g \
  -XX:+UseG1GC \
  -Dfile.encoding=UTF-8 \
  -jar dataagent-backend.jar \
  > /var/log/dataagent/console.log 2>&1 &

# æŸ¥çœ‹è¿›ç¨‹
ps aux | grep dataagent-backend

# éªŒè¯ç›‘å¬åœ°å€ï¼ˆåº”è¯¥åŒæ—¶æ˜¾ç¤º IPv4 å’Œ IPv6ï¼‰
netstat -anlp | grep 8065
# é¢„æœŸè¾“å‡ºï¼š
# tcp   0  0  0.0.0.0:8065  0.0.0.0:*  LISTEN  <PID>/java
# tcp6  0  0  :::8065       :::*       LISTEN  <PID>/java

# æŸ¥çœ‹æ—¥å¿—
tail -f /var/log/dataagent/console.log
```

**ç½‘ç»œé…ç½®è¯´æ˜**ï¼š
- é»˜è®¤åŒæ—¶æ”¯æŒ IPv4 å’Œ IPv6 è®¿é—®
- IPv4 åœ°å€ï¼š`http://172.16.1.137:8065`
- IPv6 åœ°å€ï¼š`http://[::1]:8065` æˆ– `http://[fe80::1]:8065`
- å¦‚æœåªéœ€ IPv4ï¼Œæ·»åŠ å‚æ•°ï¼š`-Djava.net.preferIPv4Stack=true`
- å¦‚æœåªéœ€ IPv6ï¼Œæ·»åŠ å‚æ•°ï¼š`-Djava.net.preferIPv6Addresses=true`

**åˆ›å»º systemd æœåŠ¡ï¼ˆæ¨èï¼‰**ï¼š

```bash
# åˆ›å»ºæœåŠ¡æ–‡ä»¶
sudo vi /etc/systemd/system/dataagent.service
```

æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

```ini
[Unit]
Description=Audaque DataAgent Service
After=network.target mysql.service

[Service]
Type=simple
User=dataagent
WorkingDirectory=/opt/dataagent
ExecStart=/usr/bin/java -Xmx2g -Xms2g -jar /opt/dataagent/dataagent-backend.jar
Restart=always
RestartSec=10
StandardOutput=append:/var/log/dataagent/console.log
StandardError=append:/var/log/dataagent/error.log

# ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰
Environment="DATA_AGENT_DATASOURCE_PASSWORD=your_password"

# å¦‚éœ€å¼ºåˆ¶ä½¿ç”¨ IPv4ï¼Œå¯æ·»åŠ ï¼š
# Environment="JAVA_OPTS=-Djava.net.preferIPv4Stack=true"

[Install]
WantedBy=multi-user.target
```

å¯åŠ¨æœåŠ¡ï¼š

```bash
# é‡è½½ systemd é…ç½®
sudo systemctl daemon-reload

# å¯åŠ¨æœåŠ¡
sudo systemctl start dataagent

# è®¾ç½®å¼€æœºè‡ªå¯
sudo systemctl enable dataagent

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
sudo systemctl status dataagent

# æŸ¥çœ‹æ—¥å¿—
journalctl -u dataagent -f
```

#### 5.5 éƒ¨ç½²å‰ç«¯ï¼ˆé™æ€æ–‡ä»¶ï¼‰

**ä½¿ç”¨ Nginx éƒ¨ç½²å‰ç«¯**ï¼š

```bash
# 1. å®‰è£… Nginx
sudo apt-get install nginx  # Ubuntu/Debian
sudo yum install nginx      # CentOS/RHEL

# 2. å¤åˆ¶å‰ç«¯æ„å»ºäº§ç‰©
sudo cp -r data-agent-frontend/dist/* /var/www/dataagent/

# 3. é…ç½® Nginx
sudo vi /etc/nginx/sites-available/dataagent
```

Nginx é…ç½®ç¤ºä¾‹ï¼š

```nginx
server {
    listen 80;
    server_name your-domain.com;  # ä¿®æ”¹ä¸ºå®é™…åŸŸåæˆ– IP

    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /var/www/dataagent;
        index index.html;
        try_files $uri $uri/ /index.html;
    }

    # åç«¯ API ä»£ç†
    location /api/ {
        proxy_pass http://localhost:8065/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # æ–‡ä»¶ä¸Šä¼ é…ç½®
    client_max_body_size 10M;
}
```

å¯ç”¨é…ç½®å¹¶é‡å¯ Nginxï¼š

```bash
# å¯ç”¨ç«™ç‚¹é…ç½®
sudo ln -s /etc/nginx/sites-available/dataagent /etc/nginx/sites-enabled/

# æµ‹è¯•é…ç½®
sudo nginx -t

# é‡å¯ Nginx
sudo systemctl restart nginx
```

### 6. è®¿é—®ç³»ç»Ÿ

- **å¼€å‘ç¯å¢ƒ**ï¼š`http://localhost:3000`
- **ç”Ÿäº§ç¯å¢ƒ**ï¼š`http://your-domain.com` æˆ– `http://your-server-ip`

å¼€å§‹åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªæ•°æ®æ™ºèƒ½ä½“ï¼

## ğŸ“š æ–‡æ¡£å¯¼èˆª

| æ–‡æ¡£                                        | æ­¤æ–‡æ¡£åŒ…å«çš„å†…å®¹                                                   |
| :------------------------------------------ | :----------------------------------------------------------------- |
| [å¿«é€Ÿå¼€å§‹](docs/QUICK_START.md)             | ç¯å¢ƒè¦æ±‚ã€æ•°æ®åº“å¯¼å…¥ã€åŸºç¡€é…ç½®ã€ç³»ç»Ÿåˆä½“éªŒ                         |
| [æ¶æ„è®¾è®¡](docs/ARCHITECTURE.md)            | ç³»ç»Ÿåˆ†å±‚æ¶æ„ã€StateGraphä¸å·¥ä½œæµè®¾è®¡ã€æ ¸å¿ƒæ¨¡å—æ—¶åºå›¾               |
| [å¼€å‘è€…æŒ‡å—](docs/DEVELOPER_GUIDE.md)       | å¼€å‘ç¯å¢ƒæ­å»ºã€è¯¦ç»†é…ç½®æ‰‹å†Œã€ä»£ç è§„èŒƒã€æ‰©å±•å¼€å‘(å‘é‡åº“/æ¨¡å‹)        |
| [é«˜çº§åŠŸèƒ½](docs/ADVANCED_FEATURES.md)       | API Key è°ƒç”¨ã€MCP æœåŠ¡å™¨é…ç½®ã€è‡ªå®šä¹‰æ··åˆæ£€ç´¢ç­–ç•¥ã€Pythonæ‰§è¡Œå™¨é…ç½® |
| [çŸ¥è¯†é…ç½®æœ€ä½³å®è·µ](docs/KNOWLEDGE_USAGE.md) | è¯­ä¹‰æ¨¡å‹ï¼Œä¸šåŠ¡çŸ¥è¯†ï¼Œæ™ºèƒ½ä½“çŸ¥è¯†çš„è§£é‡Šå’Œä½¿ç”¨                         |

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ Apache License 2.0 è®¸å¯è¯ã€‚

---

<div align="center">
    Made with â¤ï¸ by Spring AI Audaque DataAgent Team
</div>
