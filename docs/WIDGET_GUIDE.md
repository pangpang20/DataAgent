# DataAgent ç½‘é¡µåµŒå…¥ Widget ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

DataAgent Widget å…è®¸æ‚¨å°† AI æ™ºèƒ½ä½“èŠå¤©çª—å£åµŒå…¥åˆ°ä»»ä½•ç½‘ç«™ä¸­ï¼Œä¸ºæ‚¨çš„ç”¨æˆ·æä¾›ä¾¿æ·çš„ AI åŠ©æ‰‹æœåŠ¡ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ¨ å¯è‡ªå®šä¹‰ä¸»é¢˜é¢œè‰²å’Œä½ç½®
- ğŸ’¬ å®æ—¶æµå¼å¯¹è¯å“åº”
- ğŸ“± å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒç§»åŠ¨ç«¯
- ğŸ”’ åŸºäº API Key çš„å®‰å…¨è®¤è¯
- âš¡ è½»é‡çº§ï¼Œå¿«é€ŸåŠ è½½

## å¿«é€Ÿå¼€å§‹

### 1. ç”Ÿæˆ API Key

1. ç™»å½• DataAgent ç®¡ç†åå°
2. è¿›å…¥æ™ºèƒ½ä½“è¯¦æƒ…é¡µ
3. ç‚¹å‡»ã€Œè®¿é—® APIã€æ ‡ç­¾
4. ç‚¹å‡»ã€Œç”Ÿæˆ Keyã€æŒ‰é’®
5. å¤åˆ¶ç”Ÿæˆçš„ API Key

### 2. è·å–åµŒå…¥ä»£ç 

åœ¨ã€Œè®¿é—® APIã€é¡µé¢çš„ã€Œç½‘é¡µåµŒå…¥ã€æ ‡ç­¾ä¸­ï¼š

1. é…ç½®çª—å£æ ‡é¢˜ã€æŒ‰é’®ä½ç½®ã€ä¸»é¢˜è‰²å’Œæ¬¢è¿æ¶ˆæ¯
2. ç‚¹å‡»ã€Œå¤åˆ¶ä»£ç ã€æŒ‰é’®
3. å°†ä»£ç ç²˜è´´åˆ°æ‚¨çš„ç½‘é¡µ `</body>` æ ‡ç­¾ä¹‹å‰

### 3. ç¤ºä¾‹ä»£ç 

```html
<!DOCTYPE html>
<html>
<head>
  <title>æˆ‘çš„ç½‘ç«™</title>
</head>
<body>
  <h1>æ¬¢è¿è®¿é—®æˆ‘çš„ç½‘ç«™</h1>
  <!-- æ‚¨çš„ç½‘é¡µå†…å®¹ -->

  <!-- DataAgent Widget åµŒå…¥ä»£ç  -->
  <script>
    window.DataAgentConfig = {
      "agentId": 1,
      "apiKey": "your-api-key-here",
      "title": "AI åŠ©æ‰‹",
      "position": "bottom-right",
      "primaryColor": "#409EFF",
      "welcomeMessage": "æ‚¨å¥½ï¼æˆ‘æ˜¯ AI åŠ©æ‰‹ï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®æ‚¨çš„å—ï¼Ÿ"
    };
  </script>
  <script src="https://your-domain.com/widget.js"></script>
</body>
</html>
```

## é…ç½®é€‰é¡¹

| å‚æ•°             | ç±»å‹   | å¿…å¡« | é»˜è®¤å€¼                                     | è¯´æ˜                                        |
| ---------------- | ------ | ---- | ------------------------------------------ | ------------------------------------------- |
| `agentId`        | number | æ˜¯   | -                                          | æ™ºèƒ½ä½“ ID                                   |
| `apiKey`         | string | æ˜¯   | -                                          | API Key                                     |
| `title`          | string | å¦   | "AI åŠ©æ‰‹"                                  | èŠå¤©çª—å£æ ‡é¢˜                                |
| `position`       | string | å¦   | "bottom-right"                             | æŒ‰é’®ä½ç½®ï¼ˆ`bottom-right` æˆ– `bottom-left`ï¼‰ |
| `primaryColor`   | string | å¦   | "#409EFF"                                  | ä¸»é¢˜é¢œè‰²ï¼ˆåå…­è¿›åˆ¶é¢œè‰²å€¼ï¼‰                  |
| `welcomeMessage` | string | å¦   | "æ‚¨å¥½ï¼æˆ‘æ˜¯ AI åŠ©æ‰‹ï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®æ‚¨çš„å—ï¼Ÿ" | æ¬¢è¿æ¶ˆæ¯                                    |
| `baseUrl`        | string | å¦   | å½“å‰åŸŸå                                   | API æœåŠ¡åœ°å€ï¼ˆè·¨åŸŸéƒ¨ç½²æ—¶éœ€è¦é…ç½®ï¼‰          |

## å¼€å‘ä¸æ„å»º

### æ„å»º Widget

```bash
# è¿›å…¥å‰ç«¯ç›®å½•
cd data-agent-frontend

# å®‰è£…ä¾èµ–
npm install

# æ„å»º Widget
npm run build:widget

# åŒæ—¶æ„å»ºä¸»åº”ç”¨å’Œ Widget
npm run build:all
```

æ„å»ºå®Œæˆåï¼Œ`widget.js` æ–‡ä»¶å°†ç”Ÿæˆåœ¨ `dist` ç›®å½•ä¸­ã€‚

### æœ¬åœ°æµ‹è¯•

1. æ„å»º Widgetï¼š
```bash
npm run build:widget
```

2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼š
```bash
npm run dev
```

3. è®¿é—®æµ‹è¯•é¡µé¢ï¼š
```
http://localhost:3000/widget-test.html
```

4. ä¿®æ”¹ `public/widget-test.html` ä¸­çš„ `agentId` å’Œ `apiKey` ä¸ºæ‚¨çš„å®é™…å€¼

## éƒ¨ç½²

### 1. æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build:all
```

### 2. éƒ¨ç½²æ–‡ä»¶

å°† `dist` ç›®å½•ä¸­çš„ä»¥ä¸‹æ–‡ä»¶éƒ¨ç½²åˆ°æ‚¨çš„æœåŠ¡å™¨ï¼š

- `widget.js` - Widget ä¸»æ–‡ä»¶
- å…¶ä»–ä¸»åº”ç”¨æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰

### 3. é…ç½® CORS

ç¡®ä¿æ‚¨çš„åç«¯ API æœåŠ¡å™¨é…ç½®äº†æ­£ç¡®çš„ CORS å¤´ï¼š

```java
@CrossOrigin(origins = "*")  // æˆ–æŒ‡å®šå…è®¸çš„åŸŸå
```

### 4. ä½¿ç”¨ CDNï¼ˆæ¨èï¼‰

å°† `widget.js` éƒ¨ç½²åˆ° CDN ä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½ï¼š

```html
<script src="https://cdn.your-domain.com/widget.js"></script>
```

## æ ·å¼è‡ªå®šä¹‰

Widget æä¾›ä»¥ä¸‹è‡ªå®šä¹‰é€‰é¡¹ï¼š

### ä¸»é¢˜é¢œè‰²

é€šè¿‡ `primaryColor` å‚æ•°è‡ªå®šä¹‰ä¸»é¢˜é¢œè‰²ï¼š

```javascript
window.DataAgentConfig = {
  // ... å…¶ä»–é…ç½®
  "primaryColor": "#FF5722"  // æ©™è‰²ä¸»é¢˜
};
```

### æŒ‰é’®ä½ç½®

æ”¯æŒä¸¤ç§ä½ç½®ï¼š

- `bottom-right`ï¼šå³ä¸‹è§’ï¼ˆé»˜è®¤ï¼‰
- `bottom-left`ï¼šå·¦ä¸‹è§’

```javascript
window.DataAgentConfig = {
  // ... å…¶ä»–é…ç½®
  "position": "bottom-left"
};
```

## æ•…éšœæ’æŸ¥

### Widget æœªæ˜¾ç¤º

1. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
2. ç¡®è®¤ `widget.js` æ–‡ä»¶è·¯å¾„æ­£ç¡®
3. ç¡®è®¤ `window.DataAgentConfig` é…ç½®æ­£ç¡®
4. ç¡®è®¤ API Key å·²ç”Ÿæˆå¹¶å¯ç”¨

### æ— æ³•å‘é€æ¶ˆæ¯

1. æ£€æŸ¥ API Key æ˜¯å¦æ­£ç¡®
2. æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
3. æ£€æŸ¥ç½‘ç»œè¯·æ±‚æ˜¯å¦è¢« CORS ç­–ç•¥é˜»æ­¢
4. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°çš„ç½‘ç»œè¯·æ±‚æ—¥å¿—

### è·¨åŸŸé—®é¢˜

å¦‚æœ Widget å’Œ API æœåŠ¡åœ¨ä¸åŒåŸŸåä¸‹ï¼Œéœ€è¦ï¼š

1. é…ç½® `baseUrl` å‚æ•°æŒ‡å‘ API æœåŠ¡åœ°å€
2. ç¡®ä¿ API æœåŠ¡å™¨é…ç½®äº†æ­£ç¡®çš„ CORS å¤´

```javascript
window.DataAgentConfig = {
  // ... å…¶ä»–é…ç½®
  "baseUrl": "https://api.your-domain.com"
};
```

## å®‰å…¨å»ºè®®

1. **ä¿æŠ¤ API Key**ï¼šä¸è¦åœ¨å…¬å¼€çš„ä»£ç ä»“åº“ä¸­æ³„éœ² API Key
2. **é™åˆ¶åŸŸå**ï¼šåœ¨åç«¯é…ç½® CORS æ—¶ï¼Œå»ºè®®æŒ‡å®šå…è®¸çš„åŸŸåè€Œä¸æ˜¯ä½¿ç”¨ `*`
3. **å®šæœŸæ›´æ¢**ï¼šå®šæœŸé‡ç½® API Key ä»¥æé«˜å®‰å…¨æ€§
4. **ç›‘æ§ä½¿ç”¨**ï¼šé€šè¿‡åå°ç›‘æ§ API è°ƒç”¨æƒ…å†µï¼Œå‘ç°å¼‚å¸¸åŠæ—¶å¤„ç†

## æŠ€æœ¯æ¶æ„

- **å‰ç«¯æ¡†æ¶**ï¼šVue 3 + TypeScript
- **æ„å»ºå·¥å…·**ï¼šVite
- **HTTP å®¢æˆ·ç«¯**ï¼šAxios
- **å®æ—¶é€šä¿¡**ï¼šServer-Sent Events (SSE)
- **æ‰“åŒ…æ ¼å¼**ï¼šIIFEï¼ˆç«‹å³æ‰§è¡Œå‡½æ•°ï¼‰

## æµè§ˆå™¨å…¼å®¹æ€§

- Chrome/Edge >= 90
- Firefox >= 88
- Safari >= 14
- ç§»åŠ¨ç«¯æµè§ˆå™¨ï¼ˆiOS Safari, Chrome Androidï¼‰

## è®¸å¯è¯

Apache License 2.0

## æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»æŠ€æœ¯æ”¯æŒæˆ–åœ¨é¡¹ç›®ä¸­æäº¤ Issueã€‚
